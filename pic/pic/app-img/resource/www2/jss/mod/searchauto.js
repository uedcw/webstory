define(["jquery"],function(e){function u(s){t=e('<ul id="'+s+'"></ul>').appendTo(document.body).on("mouseenter","li",function(){var t=e(this);i=t.index(),t.siblings().removeClass("current"),t.addClass("current")}).on("mouseleave","li",function(){e(this).removeClass("current")}).on("click","li",function(){var i=r[e(this).index()].keys;n.val(i),t.hide(),e("#form1-top-search").submit()})}function a(e){try{if(e.target.parentNode.id=="auto_complete_layer")return;t.hide()}catch(n){}}function f(){e("input.s_key_input").focus(function(){e(document).on("mousedown",a)}).blur(function(){e(document).off("mousedown",a)}).on("keyup",function(a){var f=a.which;if(f==13)return;if(f==38||f==40){try{if(!t.length||t.is(":hidden"))return}catch(l){return}var c=t.find("li"),h=c.length,p=i;f==38?i--:i++;if(i>=h||i<0)i=f==38?h:-1;if(i===-1||i===h){n.val(s),c.removeClass("current");return}p!==-1&&c.eq(p).removeClass("current");var d=c.eq(i).addClass("current").text();n.val(r[i].keys);return}n=e(this);var v=n.val();if(v.length<3){try{t.hide()}catch(l){return}return}if(v===s)return;s=v;var m="auto_complete_layer";e("#"+m).length||u(m);var g="";e.get("/"+o+"/search.html?search_type=text&search_type=remind&lang="+o,{search_keyword:v},function(i){if(!i.done)return;if(i.retval.len){r=i.retval.rows,e.each(i.retval.rows,function(e,t){g+="<li>"+t.connect+"</li>"});var s=n.offset();t.html(g).css({width:n.outerWidth()-2,left:s.left,top:s.top+n.outerHeight(),display:"block"})}else t.hide()},"json")})}var t=null,n=null,r=null,i=-1,s="",o=window.DB.leng;return{init:f}});