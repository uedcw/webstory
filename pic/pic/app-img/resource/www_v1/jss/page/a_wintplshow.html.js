define("ajaxtpl_new",["jquery"],function(e){var t=window.DB.leng;return function(n,r,i){r=r||e.noop(),i=i||"index";var s=document.getElementById(n);s?r(s,n,i):e.get("/dialog_page//wintpl/"+n+"_"+t+".html",function(t){t!==""?(e(document.body).append(t),r(document.getElementById(n),n,i)):alert("no tpl: "+n)})}}),define("popup",["jquery"],function(e){function i(){this.destroyed=!1,this.__popup=e("<div />").css({display:"none",position:"absolute",outline:0}).attr("tabindex","-1").html(this.innerHTML).appendTo("body"),this.__backdrop=this.__mask=e("<div />").css({opacity:.7,background:"#000"}),this.node=this.__popup[0],this.backdrop=this.__backdrop[0],t++}var t=0,n=!("minWidth"in e("html")[0].style),r=!n;return e.extend(i.prototype,{node:null,backdrop:null,fixed:!1,destroyed:!0,open:!1,returnValue:"",autofocus:!0,align:"bottom left",innerHTML:"",className:"ui-popup",show:function(t){if(this.destroyed)return this;var s=this,o=this.__popup,u=this.__backdrop;this.__activeElement=this.__getActive(),this.open=!0,this.follow=t||this.follow;if(!this.__ready){o.addClass(this.className).attr("role",this.modal?"alertdialog":"dialog").css("position",this.fixed?"fixed":"absolute"),n||e(window).on("resize",e.proxy(this.reset,this));if(this.modal){var a={position:"fixed",left:0,top:0,width:"100%",height:"100%",overflow:"hidden",userSelect:"none",zIndex:this.zIndex||i.zIndex};o.addClass(this.className+"-modal"),r||e.extend(a,{position:"absolute",width:e(window).width()+"px",height:e(document).height()+"px"}),u.css(a).attr({tabindex:"0"}).on("focus",e.proxy(this.focus,this)),this.__mask=u.clone(!0).attr("style","").insertAfter(o),u.addClass(this.className+"-backdrop").insertBefore(o),this.__ready=!0}o.html()||o.html(this.innerHTML)}return o.addClass(this.className+"-show").show(),u.show(),this.reset().focus(),this.__dispatchEvent("show"),this},showModal:function(){return this.modal=!0,this.show.apply(this,arguments)},close:function(e){return!this.destroyed&&this.open&&(e!==undefined&&(this.returnValue=e),this.__popup.hide().removeClass(this.className+"-show"),this.__backdrop.hide(),this.open=!1,this.blur(),this.__dispatchEvent("close")),this},remove:function(){if(this.destroyed)return this;this.__dispatchEvent("beforeremove"),i.current===this&&(i.current=null),this.__popup.remove(),this.__backdrop.remove(),this.__mask.remove(),n||e(window).off("resize",this.reset),this.__dispatchEvent("remove");for(var t in this)delete this[t];return this},reset:function(){var e=this.follow;return e?this.__follow(e):this.__center(),this.__dispatchEvent("reset"),this},focus:function(){var t=this.node,n=this.__popup,r=i.current,s=this.zIndex=i.zIndex++;r&&r!==this&&r.blur(!1);if(!e.contains(t,this.__getActive())){var o=n.find("[autofocus]")[0];!this._autofocus&&o?this._autofocus=!0:o=t,this.__focus(o)}return n.css("zIndex",s),i.current=this,n.addClass(this.className+"-focus"),this.__dispatchEvent("focus"),this},blur:function(){var e=this.__activeElement,t=arguments[0];return t!==!1&&this.__focus(e),this._autofocus=!1,this.__popup.removeClass(this.className+"-focus"),this.__dispatchEvent("blur"),this},addEventListener:function(e,t){return this.__getEventListener(e).push(t),this},removeEventListener:function(e,t){var n=this.__getEventListener(e);for(var r=0;r<n.length;r++)t===n[r]&&n.splice(r--,1);return this},__getEventListener:function(e){var t=this.__listener;return t||(t=this.__listener={}),t[e]||(t[e]=[]),t[e]},__dispatchEvent:function(e){var t=this.__getEventListener(e);this["on"+e]&&this["on"+e]();for(var n=0;n<t.length;n++)t[n].call(this)},__focus:function(e){try{this.autofocus&&!/^iframe$/i.test(e.nodeName)&&e.focus()}catch(t){}},__getActive:function(){try{var e=document.activeElement,t=e.contentDocument,n=t&&t.activeElement||e;return n}catch(r){}},__center:function(){var t=this.__popup,n=e(window),r=e(document),i=this.fixed,s=i?0:r.scrollLeft(),o=i?0:r.scrollTop(),u=n.width(),a=n.height(),f=t.width(),l=t.height(),c=(u-f)/2+s,h=(a-l)*382/1e3+o,p=t[0].style;p.left=Math.max(parseInt(c),s)+"px",p.top=Math.max(parseInt(h),o)+"px"},__follow:function(t){var n=t.parentNode&&e(t),r=this.__popup;this.__followSkin&&r.removeClass(this.__followSkin);if(n){var i=n.offset();if(i.left*i.top<0)return this.__center()}var s=this,o=this.fixed,u=e(window),a=e(document),f=u.width(),l=u.height(),c=a.scrollLeft(),h=a.scrollTop(),p=r.width(),d=r.height(),v=n?n.outerWidth():0,m=n?n.outerHeight():0,g=this.__offset(t),y=g.left,b=g.top,w=o?y-c:y,E=o?b-h:b,S=o?0:c,x=o?0:h,T=S+f-p,N=x+l-d,C={},k=this.align.split(" "),L=this.className+"-",A={top:"bottom",bottom:"top",left:"right",right:"left"},O={top:"top",bottom:"top",left:"left",right:"left"},M=[{top:E-d,bottom:E+m,left:w-p,right:w+v},{top:E,bottom:E-d+m,left:w,right:w-p+v}],_={left:w+v/2-p/2,top:E+m/2-d/2},D={left:[S,T],top:[x,N]};e.each(k,function(e,t){M[e][t]>D[O[t]][1]&&(t=k[e]=A[t]),M[e][t]<D[O[t]][0]&&(k[e]=A[t])}),k[1]||(O[k[1]]=O[k[0]]==="left"?"top":"left",M[1][k[1]]=_[O[k[1]]]),L+=k.join("-")+" "+this.className+"-follow",s.__followSkin=L,n&&r.addClass(L),C[O[k[0]]]=parseInt(M[0][k[0]]),C[O[k[1]]]=parseInt(M[1][k[1]]),r.css(C)},__offset:function(t){var n=t.parentNode,r=n?e(t).offset():{left:t.pageX,top:t.pageY};t=n?t:t.target;var i=t.ownerDocument,s=i.defaultView||i.parentWindow;if(s==window)return r;var o=s.frameElement,u=e(i),a=u.scrollLeft(),f=u.scrollTop(),l=e(o).offset(),c=l.left,h=l.top;return{left:r.left+c-a,top:r.top+h-f}}}),i.zIndex=1024,i.current=null,i}),define("dialog-config",{autofocusDefBut:"ok",backdropBackground:"#000",backdropOpacity:.7,content:'<span class="ui-dialog-loading">Loading..</span>',title:"",statusbar:"",button:null,ok:null,cancel:null,okValue:"OK",cancelValue:"Cancel",cancelDisplay:!0,width:"",height:"",padding:"",skin:"",quickClose:!1,cssUri:"",innerHTML:'<div i="dialog" class="ui-dialog"><div class="ui-dialog-arrow-a"></div><div class="ui-dialog-arrow-b"></div><table class="ui-dialog-grid"><tr><td i="header" class="ui-dialog-header"><button i="close" class="ui-dialog-close">&#215;</button><div i="title" class="ui-dialog-title"></div></td></tr><tr><td i="body" class="ui-dialog-body"><div i="content" class="ui-dialog-content"></div></td></tr><tr><td i="footer" class="ui-dialog-footer"><div i="statusbar" class="ui-dialog-statusbar"></div><div i="button" class="ui-dialog-button"></div></td></tr></table></div>'}),define("dialog",["jquery","popup","dialog-config"],function(e,t,n){var r=0,i=new Date-0,s=!("minWidth"in e("html")[0].style),o="createTouch"in document&&!("onmousemove"in document)||/(iPhone|iPad|iPod)/i.test(navigator.userAgent),u=!s&&!o,a=function(t,n,s){var f=t=t||{};if(typeof t=="string"||t.nodeType===1)t={content:t,fixed:!o};t=e.extend(!0,{},a.defaults,t),t.original=f;var l=t.id=t.id||i+r,c=a.get(l);return c?c.focus():(u||(t.fixed=!1),t.quickClose&&(t.modal=!0,t.backdropOpacity=0),e.isArray(t.button)||(t.button=[]),s!==undefined&&(t.cancel=s),t.cancel&&t.button.push({id:"cancel",value:t.cancelValue,callback:t.cancel,display:t.cancelDisplay,autofocus:t.autofocusDefBut=="cancel"}),n!==undefined&&(t.ok=n),t.ok&&t.button.push({id:"ok",value:t.okValue,callback:t.ok,autofocus:t.autofocusDefBut=="ok"}),a.list[l]=new a.create(t))},f=function(){};f.prototype=t.prototype;var l=a.prototype=new f;return a.create=function(n){var i=this;e.extend(this,new t);var s=n.original,o=e(this.node).html(n.innerHTML),u=e(this.backdrop);return this.options=n,this._popup=o,e.each(n,function(e,t){typeof i[e]=="function"?i[e](t):i[e]=t}),n.zIndex&&(t.zIndex=n.zIndex),o.attr({"aria-labelledby":this._$("title").attr("id","title:"+this.id).attr("id"),"aria-describedby":this._$("content").attr("id","content:"+this.id).attr("id")}),this._$("close").css("display",this.cancel===!1?"none":"").attr("title",this.cancelValue).on("click",function(e){i._trigger("cancel"),e.preventDefault()}),this._$("dialog").addClass(this.skin),this._$("body").css("padding",this.padding),n.quickClose&&u.on("onmousedown"in document?"mousedown":"click",function(){return i._trigger("cancel"),!1}),this.addEventListener("show",function(){u.css({opacity:0,background:n.backdropBackground}).animate({opacity:n.backdropOpacity},150)}),this._esc=function(e){var n=e.target,r=n.nodeName,s=/^input|textarea$/i,o=t.current===i,u=e.keyCode;if(!o||s.test(r)&&n.type!=="button")return;u===27&&i._trigger("cancel")},e(document).on("keydown",this._esc),this.addEventListener("remove",function(){e(document).off("keydown",this._esc),delete a.list[this.id]}),r++,a.oncreate(this),this},a.create.prototype=l,e.extend(l,{content:function(t){var n=this._$("content");return typeof t=="object"?(t=e(t),n.empty("").append(t.show()),this.addEventListener("beforeremove",function(){e("body").append(t.hide())})):n.html(t),this.reset()},title:function(e){return this._$("title").text(e),this._$("header")[e?"show":"hide"](),this},width:function(e){return this._$("content").css("width",e),this.reset()},height:function(e){return this._$("content").css("height",e),this.reset()},button:function(t){t=t||[];var n=this,r="",i=0;return this.callbacks={},typeof t=="string"?(r=t,i++):e.each(t,function(t,s){var o=s.id=s.id||s.value,u="";n.callbacks[o]=s.callback,s.display===!1?u=' style="display:none"':i++,r+='<button type="button" i-id="'+o+'"'+u+(s.disabled?" disabled":"")+(s.autofocus?' autofocus class="ui-dialog-autofocus"':"")+">"+s.value+"</button>",n._$("button").on("click","[i-id="+o+"]",function(t){var r=e(this);r.attr("disabled")||n._trigger(o),t.preventDefault()})}),this._$("button").html(r),this._$("footer")[i?"show":"hide"](),this},statusbar:function(e){return this._$("statusbar").html(e)[e?"show":"hide"](),this},_$:function(e){return this._popup.find("[i="+e+"]")},_trigger:function(e){var t=this.callbacks[e];return typeof t!="function"||t.call(this)!==!1?this.close().remove():this}}),a.oncreate=e.noop,a.getCurrent=function(){return t.current},a.get=function(e){return e===undefined?a.list:a.list[e]},a.list={},a.defaults=n,a}),define("message_new",["jquery","ajaxtpl_new","dialog"],function(e,t,n){function o(e,t){e=e||"success";var n=i?' style="'+i+'"':"",r=s?" "+s:"";return'<table class="sys_mess"><tr><th valign="center"><div class="ico ico_'+e+'"></div></th><td valign="center"><div class="msg'+s+'"'+n+">"+t+"</div></td></tr></table>"}function u(t,i,s){var u=e.extend({title:r.title,content:""},s);return u.content||(u.content=o(t,i)),n(u)}function a(t){return e.isFunction(t)}function f(t){var n={autofocusDefBut:"cancel",cancelValue:r.cancel,cancel:function(){return!0}};return typeof t=="undefined"?n:a(t)?(n.cancel=t,n):("styles"in t&&(i=t.styles,delete t.styles),"addcss"in t&&(s=t.addcss,delete t.addcss),e.isEmptyObject(t)?n:e.extend(n,t))}function l(e,t){var n=f(t);n.cancelValue=r.ok;var i=u("success",e,n);return i.showModal()}function c(e,t){var n=f(t),r=u("error",e,n);return r.showModal()}function h(e,t){var n=f(t),r=u("warning",e,n);return r.showModal()}function p(r,i,s,o){i=i||e.noop(),s=s||e.noop(),o=o||"index",t(r,function(e,t,r){n({id:t+"_win",content:e,title:"loading",onshow:i,onremove:s}).showModal()},o)}if(window["DB"].leng=="zh")var r={title:"消 息",ok:"确 定",cancel:"取 消"};else var r={title:"Message",ok:"OK",cancel:"Cancel"};var i="",s="";return{success:l,ok:l,error:c,warning:h,win:p,dialog:n}}),define("page/a_wintplshow.html",["module","jquery","message_new"],function(e,t,n){t(document).ready(function(){t("button").each(function(){var e=t(this),n=e.data("tpl"),r=e.text();e.data("tit",r),e.text(r+" -- #"+n),e.find("s").text(n)}).on("click",function(){var e=t(this),r=e.data("tit"),i=e.data("tpl");n.win(i,function(){var e=this,n=t("#"+i);n.data("bind")||(n.data("bind",1),t("#close_"+i).on("click",function(){e.remove()})),e.title(r)},function(){})}),t("#open").click()})});