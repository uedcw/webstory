define(["module","jquery","message"],function(e,t,n){function o(){var e=t(this),o=e.data("gid").toInt();if(!o)return;var u=t(this).data("isfav").toInt(),a=t(this).data("is5").toInt(),f=t("#add_fav_sort_done");if(a){n.warning(s);return}f.data("bind")||(f.data("bind",1),t("#close_add_fav_sort_done").on("click",function(){i.get("add_fav_sort_done_win").remove()})),u||t.when(t.post("./index.php?app=goods&act=Addtosupplier",{store_id:o}),t.post("/?app=my_favorite&act=add&type=store&ajax=1&lang="+r,{item_id:o})).done(function(e,o){var u=t.trim(e[2].responseText).toInt(),a=JSON.parse(t.trim(o[2].responseText));if(u==0||!a.retval.islogin)window.location.href="/en/login.html";else{if(u==3){t("#add_fav_store_mark").html(r=="zh"?"已关注":"In Bookmark"),n.warning(s);return}t("#add_fav_store_mark").html(r=="zh"?"已关注":"In Bookmark"),i({id:"add_fav_sort_done_win",title:r=="zh"?"关注店铺":"Supplier Added to Bookmark",content:f}).showModal()}})}var r=window.DB.leng,i=n.dialog,s=r=="zh"?"对不起！您最多关注50个供应商":"Sorry, only 50 suppliers at most in your attention.";return{bind:o}});