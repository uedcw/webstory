define(["jquery","cookie"],function(e){var t=!1,n=window.DB.leng,r={data:[{left:190,top:-194,id:"float_filter"},{left:50,top:-204,id:"guide_step_2"},{left:50,top:-204,id:"guide_step_3"}],on_step:0,on_txt:null,setp_len:3,setp_lay:e("#step_lay"),step_mat:e("#step_mat"),step_box:e("#step_box"),cone_but:null,step_eo4:null,init:function(){t=!0,this.setp_lay.show(),e(".guide_step_4").length&&(this.data.push({left:0,top:0,id:"guide_step_4"}),this.step_box.find(".ck1").hide(),this.step_box.find(".tc").text(4)),this.setp_len=this.data.length,this.step_box.find(".buts_def1").on("click",function(){r.next()}),e("#step_box_close").on("click",function(){r.close()}),r.next()},close:function(){this.on_step++,this.clean(),this.cone_but&&this.cone_but.remove(),e("#step_lay,#step_lay1,#step_lay2,#step_lay3,#step_mat,#step_mat1,#step_box").hide(),e("#step_lay").trigger("myclose"),e.cookie("g_step_tmp",1,{expires:360,path:"/"}),e.post("/?app=search&act=ajax_set_user_display",function(e){return!0})},clean:function(){var t=this.on_step-1;try{var n=this.data[t-1];if(!n)throw new Error("end")}catch(r){this.eo4&&this.eo4.removeClass("step_pos");return}var i=e("#"+n.id);this.on_txt.hide();if(t===2){e("#step_lay1").hide(),i.removeClass("step_pos");return}if(t===3){e("#step_lay1").hide(),i.add(i.next()).removeClass("step_pos");return}i.removeClass("step_pos");return},next:function(){this.on_step++;try{var t=this.data[this.on_step-1];if(!t)throw new Error("end")}catch(i){r.close();return}this.on_step>1&&this.clean();var s=0;if(this.on_step===4){this.eo4=e("."+t.id),s=this.eo4.length;if(!s){this.step_box.removeClass("step_box"+(this.on_step-1));return}var o=this.eo4.eq(0)}else var o=e("#"+t.id);var u=o.width(),a=o.height(),f=o.offset();this.step_box.find(".txt").hide(),this.on_txt=this.step_box.find(".txt"+this.on_step).show(),this.step_box.find(".in").text(this.on_step),this.step_box.removeClass("step_box"+(this.on_step-1)).addClass("step_box"+this.on_step).css({left:f.left+t.left,top:f.top+t.top,display:"block"}),this.step_mat.add("#step_lay2").css({width:u,height:a,left:f.left,top:f.top,display:"block"});if(this.on_step===2){e("#step_lay1").css({width:718,height:32,left:f.left+480,top:f.top,display:"block"}),o.addClass("step_pos");return}if(this.on_step===3){this.setp_len===3&&e("#step_box_next").text(function(){return e(this).data("txt")});var l=(a+21)*2;this.step_mat.add("#step_lay2").css({width:u,height:l,left:f.left,top:f.top,display:"block"}),e("#step_lay1").css({width:180,height:l,left:f.left+1020,top:f.top,display:"block"}),o.add(o.next()).addClass("step_pos");return}if(this.on_step===4){e("#step_box_next").text(function(){return e(this).data("txt")});if(s===1)o.hasClass("buts-bt1")?(this.cone_but=this.eo4.clone().css({position:"absolute","z-index":999922,left:f.left,top:f.top}).appendTo(document.body),this.step_mat.add("#step_lay2").css({width:u+15,height:a,padding:5,left:f.left-5,top:f.top-4,display:"block"}),this.step_box.addClass("step_box4_1").css({left:f.left+155,top:f.top-20})):(this.step_mat.add("#step_lay2").css({width:105,height:36,left:f.left-5,top:f.top-4,display:"block"}),this.step_box.addClass("step_box4_2").css({left:f.left-260,top:f.top-250}));else if(s===2){this.cone_but=this.eo4.eq(0).clone().css({position:"absolute","z-index":999922,left:f.left,top:f.top}).appendTo(document.body),this.step_mat.add("#step_lay2").css({width:u+15,height:a,padding:5,left:f.left-5,top:f.top-4,display:"block"});var c=this.eo4.eq(1).offset();e("#step_mat1,#step_lay3").css({width:105,height:36,left:c.left-5,top:c.top-4,display:"block"}),this.step_box.css({left:f.left+(n=="zh"?90:155),top:f.top-20})}this.eo4.addClass("step_pos");return}o.addClass("step_pos");return}};return{init:function(){if(t)return;if(e.cookie("g_step_tmp")){t=!0,e("#step_lay").trigger("myclose");return}r.init()}}});